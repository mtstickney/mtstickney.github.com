
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>FiddlyBits</title>
  <meta name="author" content="Matthew Stickney">

  
  <meta name="description" content="What do you do when you have to use an undocumented function? Reverse
engineer it, naturally. I was recently in the position of having to
automate &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mtstickney.github.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="FiddlyBits" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">FiddlyBits</a></h1>
  
    <h2>A technical blog about fiddly things.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mtstickney.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/12/abusing-search-paths-for-fun-and-profit/">Abusing Search Paths for Fun and Profit</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-12T19:24:00-05:00" pubdate data-updated="true">Feb 12<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>What do you do when you have to use an undocumented function? Reverse
engineer it, naturally. I was recently in the position of having to
automate some functions of an interactive tool provided by my language
environment. The language docs said the procedure I needed could be
extracted from a library distributed with the tool, but neglected to
mention what it’s parameters were or what data needed to be passed.</p>

<p>The extracted procedure was a bytecode-compiled file, so I couldn’t
examine the code, but I found a handy <a href="https://gist.github.com/abevoelker/581127">script</a> that
would extract the parameter information from the bytecode. That wasn’t
enough to use the procedure, but it did give me an idea: if I could
replace the standard procedure with my own version, I could have it
report the input it was getting when it was called.</p>

<p>I had traced the tool in Process Monitor earlier, and noticed that it
always searched for raw-source procedure files before bytecode files,
and for bytecode files before looking in a procedure library. I
whipped up a quick version of the procedure I wanted to call with the
right parameters, which would just report it’s input when run, and
plopped it next to the procedure library I’d extracted the bytecode
file from. I fired up the tool, pointed it at a file, and sure enough
it ran my procedure, reported the data, and promptly crashed.</p>

<p>That gave me enough information to use the real procedure file,
despite the total lack of documentation. The moral of the story here
is that language search paths can often be used to hook parts of an
application that otherwise be hard to reach, whether it’s bytecode
files or DLLs (LD_PRELOAD, anyone?).</p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/02/12/abusing-search-paths-for-fun-and-profit/">Abusing Search Paths for Fun and Profit</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/mtstickney">@mtstickney</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mtstickney',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Matthew Stickney -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
